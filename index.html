<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>OS_Office_ANN</title>
  <meta name="viewport" content="width=device-width, initial-scale=0.6, maximum-scale=1.0, user-scalable=no" />
  <meta name="gas-url" content="<?!= ScriptApp.getService().getUrl() ?>">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' https: data: blob:; img-src 'self' https: data: blob:; font-src 'self' https: data:; style-src 'self' 'unsafe-inline' https:; script-src 'self' 'unsafe-inline' 'unsafe-eval' https:; frame-ancestors 'self';">
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
  <meta http-equiv="Permissions-Policy" content="geolocation=(), camera=(), microphone=()">
  
  <!-- 預加載資源 -->
  <link rel="preload" href="https://fonts.googleapis.com/icon?family=Material+Icons" as="style">
  <link rel="preload" href="https://i.imgur.com/7obx0vd.jpg" as="image" crossorigin="anonymous">
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400&display=swap" as="style">
  
  <!-- jQuery UI Datetimepicker -->
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/dark-hive/jquery-ui.css">
  <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
  <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-ui-timepicker-addon/1.6.3/jquery-ui-timepicker-addon.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-ui-timepicker-addon/1.6.3/jquery-ui-timepicker-addon.min.css">
  
  <link rel="icon" type="image/png" sizes="32x32" href="https://i.imgur.com/7obx0vd.jpg">
  <link rel="apple-touch-icon" href="https://i.imgur.com/7obx0vd.jpg">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400&display=swap">
  
  <!-- 繁體中文設定 -->
  <script>
    $(function() {
      $.datepicker.regional['zh-TW'] = {
        closeText: '關閉',
        prevText: '&#x3C;上月',
        nextText: '下月&#x3E;',
        currentText: '今天',
        monthNames: ['一月','二月','三月','四月','五月','六月',
        '七月','八月','九月','十月','十一月','十二月'],
        monthNamesShort: ['一月','二月','三月','四月','五月','六月',
        '七月','八月','九月','十月','十一月','十二月'],
        dayNames: ['星期日','星期一','星期二','星期三','星期四','星期五','星期六'],
        dayNamesShort: ['週日','週一','週二','週三','週四','週五','週六'],
        dayNamesMin: ['日','一','二','三','四','五','六'],
        weekHeader: '週',
        dateFormat: 'yy-mm-dd',
        firstDay: 1,
        isRTL: false,
        showMonthAfterYear: true,
        yearSuffix: '年'
      };
      $.datepicker.setDefaults($.datepicker.regional['zh-TW']);
      
      $.timepicker.regional['zh-TW'] = {
        timeOnlyTitle: '二十四小時制',  // 修改標題為「二十四小時制」
        timeText: '時間',
        hourText: '小時',
        minuteText: '分鐘',
        secondText: '秒鐘',
        millisecText: '毫秒',
        microsecText: '微秒',
        timezoneText: '時區',
        currentText: '現在時間',
        closeText: '關閉',
        timeFormat: 'HH:mm',
        amNames: ['上午', 'AM', 'A'],
        pmNames: ['下午', 'PM', 'P'],
        isRTL: false
      };
      $.timepicker.setDefaults($.timepicker.regional['zh-TW']);
    });
  </script>
</head>

  <style>
    :root {
      /* 主題色彩 */
      --color-bg-primary: #1a1a1a;
      --color-bg-secondary: rgba(20, 20, 20, 0.95);
      --color-bg-tertiary: rgba(40, 40, 40, 0.8);
      --color-text-primary: #e0e0e0;
      --color-text-secondary: #bbb;
      --color-text-success: #2ecc71;
      --color-text-error: #e74c3c;
      
      /* 按鈕顏色 */
      --btn-on-from: #28a745;
      --btn-on-to: #1e7e34;
      --btn-off-from: #e74c3c;
      --btn-off-to: #c0392b;
      --btn-query-from: #3498db;
      --btn-query-to: #2980b9;
      --btn-test-from: #f39c12;
      --btn-test-to: #e67e22;
      --btn-form-from: #9c27b0;
      --btn-form-to: #673ab7;
      --btn-schedule-from: #e91e63;
      --btn-schedule-to: #c2185b;
      --btn-disabled-from: #666;
      --btn-disabled-to: #555;
      /* 公告按鈕 */
      --btn-notice-from: #607d8b;
      --btn-notice-to: #455a64;
      /* 主管限定 */
      --btn-manager-from: #795548;
      --btn-manager-to: #5d4037;
      /* 個人資訊 */
      --btn-personal-from: #00bcd4;
      --btn-personal-to: #0097a7;
      
      
      /* 間距設定 */
      --spacing-xs: 4px;
      --spacing-sm: 8px;
      --spacing-md: 16px;
      --spacing-lg: 20px;
      --spacing-xl: 30px;
      --border-radius-sm: 6px;
      --border-radius-md: 10px;
      --border-radius-lg: 12px;
    }
    
    input::-ms-reveal,
    input::-ms-clear { display: none !important; }
    input[type=password]::-webkit-textfield-decoration-container {
      visibility: hidden !important;
      pointer-events: none !important;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html { font-size: 100%; }
    body {
      background: linear-gradient(145deg, #0a0a0a, var(--color-bg-primary));
      font-family: 'Roboto Mono', monospace;
      color: var(--color-text-primary);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      font-weight: 700;
      text-shadow: 1px 1px 2px #000;
    }
    .container {
      background: var(--color-bg-secondary);
      border: 2px solid #333;
      border-radius: var(--border-radius-lg);
      box-shadow: 0 8px 20px rgba(0,0,0,0.8), inset 0 2px 4px rgba(255,255,255,0.05);
      padding: 40px;
      max-width: 700px;
      width: 100%;
      text-align: center;
    }
    .logo {
      width: 120px;
      margin: 0 auto 20px;
      filter: drop-shadow(0 4px 4px rgba(0,0,0,0.6));
    }
    h1 {
      font-size: 36px;
      letter-spacing: 2px;
      text-transform: uppercase;
      color: #fff;
      margin-bottom: 10px;
    }
    h2 {
      font-size: 20px;
      color: var(--color-text-secondary);
      margin-bottom: 30px;
    }
    form {
      background: var(--color-bg-tertiary);
      border: 1px solid #333;
      border-radius: var(--border-radius-md);
      padding: 20px;
      margin-bottom: 30px;
      box-shadow: inset 0 2px 8px rgba(0,0,0,0.7);
    }
    label {
      display: block;
      font-size: 18px;
      margin-bottom: 10px;
      color: #ccc;
    }
    .input-group {
      position: relative;
      margin-bottom: 8px;
    }
    input[type="password"],
    input[type="text"],
    input[type="tel"] {
      width: 100%;
      font-size: 20px;
      padding: 14px 50px 14px 16px;
      border: none;
      border-radius: var(--border-radius-sm);
      background-color: #222;
      color: #fff;
      text-align: center;
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.8);
      transition: background 0.3s, box-shadow 0.3s;
    }
    input:focus {
      background-color: #333;
      box-shadow: 0 0 8px rgba(0,176,255,0.6), inset 0 2px 6px rgba(0,0,0,0.5);
    }
    .toggle-btn {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      background: transparent;
      border: none;
      color: #aaa;
      font-size: 22px;
      cursor: pointer;
      transition: color 0.3s;
    }
    .toggle-btn:hover { color: #fff; }
    .btn-group {
      display: flex;
      flex-wrap: wrap;
      gap: var(--spacing-md);
      justify-content: center;
      margin-bottom: 20px;
      /* 確保在小螢幕上也能正常顯示 */
      align-items: center;
    }
    .btn {
      /* 固定尺寸確保一致性 */
      width: 150px;
      height: 50px;
      min-width: 150px;
      min-height: 50px;
      max-width: 150px;
      max-height: 50px;
      padding: 0;
      font-size: 17px;
      border: none;
      border-radius: var(--border-radius-md);
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.6), inset 0 -2px 0 rgba(0,0,0,0.2);
      color: #fff;
      background-size: 100% 100%;
      transition: none;
      /* 文字置中 */
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      /* 防止文字換行 */
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .btn:hover { transform: translateY(-3px); }
    .btn:active { transform: translateY(0); }
    .btn:disabled {
      opacity: 0.7;
      cursor: not-allowed;
      transform: none;
      background: linear-gradient(to right, var(--btn-disabled-from), var(--btn-disabled-to));
    }
    .btn-on { background: linear-gradient(to right, var(--btn-on-from) 0%, var(--btn-on-to) 100%); }
    .btn-off { background: linear-gradient(to right, var(--btn-off-from) 0%, var(--btn-off-to) 100%); }
    .btn-query { background: linear-gradient(to right, var(--btn-query-from) 0%, var(--btn-query-to) 100%); }
    .btn-test { background: linear-gradient(to right, var(--btn-test-from) 0%, var(--btn-test-to) 100%); }
    .btn-form { background: linear-gradient(to right, var(--btn-form-from) 0%, var(--btn-form-to) 100%); }
    .btn-schedule { background: linear-gradient(to right, var(--btn-schedule-from) 0%, var(--btn-schedule-to) 100%); }
    /* 新按鈕樣式 */
    .btn-notice { background: linear-gradient(to right, var(--btn-notice-from) 0%, var(--btn-notice-to) 100%); }
    .btn-manager { background: linear-gradient(to right, var(--btn-manager-from) 0%, var(--btn-manager-to) 100%); }
    .btn-personal { background: linear-gradient(to right, var(--btn-personal-from) 0%, var(--btn-personal-to) 100%); }
    
    .ui-timepicker-div {
      background: #333;
      color: #fff;
      width: 280px;
      min-width: 280px;
      max-width: 320px;
      background-color: #222;
      padding: 15px;
      border-radius: 0;
      border: none;
      border-top: 1px solid #444;
      box-shadow: none;
    }

    /* 🔧 修復：完全隱藏 jQuery UI Timepicker 的 grid 顯示元素 */
    .ui-timepicker-grid,
    .ui-timepicker-div .ui-timepicker-hour-label,
    .ui-timepicker-div .ui-timepicker-minute-label,
    .ui-timepicker-div .ui-widget-content,
    .ui-timepicker-div table.ui-timepicker-table,
    .ui-timepicker-div [class*="grid"],
    .ui-timepicker-div [class*="table"] {
      display: none !important;
      visibility: hidden !important;
    }

    #ui-datepicker-div {
      z-index: 10000 !important;
      background-color: #222 !important;
      padding: 0 !important;
      border: none !important;
      margin-top: 0 !important;
      box-shadow: 0 4px 12px rgba(0,0,0,0.5) !important;
      position: absolute !important;
      transform: none !important;
      margin-left: 0 !important;
      margin-right: 0 !important;
      width: 320px !important;
      min-width: 280px !important;
      max-width: 360px !important;
    }
    
    /* 確保月份切換時保持一致性 */
    #ui-datepicker-div .ui-datepicker {
      width: 100% !important;
      box-sizing: border-box !important;
    }
    
    /* 確保日曆表格佈局穩定 */
    #ui-datepicker-div .ui-datepicker-calendar {
      width: 100% !important;
      table-layout: fixed !important;
    }

    .ui-timepicker-div dl {
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: flex-start;
      margin: 0;
      padding: 0;
    }

    .ui-slider {
      display: none;
    }

    .ui-timepicker-div dd {
      margin: 0;
      padding: 0;
      width: 48%;
      text-align: center;
    }

    .ui-timepicker-div dd.ui_tpicker_hour:before {
      content: '小時';
      display: block;
      margin-bottom: 5px;
      color: #ccc;
      font-size: 14px;
      text-align: center;
    }

    .ui-timepicker-div dd.ui_tpicker_minute:before {
      content: '分鐘';
      display: block;
      margin-bottom: 5px;
      color: #ccc;
      font-size: 14px;
      text-align: center;
    }

    .ui-timepicker-div select {
      width: 95%;
      margin: 0 auto;
      text-align: center;
      text-align-last: center;
      -moz-text-align-last: center;
      -webkit-text-align-last: center;
    }

    .ui-timepicker-div select option {
      text-align: center;
    }

    .ui-timepicker-div .timepicker-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid #444;
    }

    .ui-timepicker-div .timepicker-button {
      background-color: #333;
      color: #fff;
      border: 1px solid #555;
      border-radius: 5px;
      padding: 8px 15px;
      font-size: 14px;
      cursor: pointer;
      transition: background-color 0.2s;
      min-width: 80px;
      text-align: center;
    }

    .ui-timepicker-div .timepicker-button.confirm {
      background-color: #2c7a3e;
      border-color: #1e5a2d;
    }

    .ui-timepicker-div .timepicker-button.cancel {
      background-color: #666;
      border-color: #555;
    }

    .ui-timepicker-div .timepicker-button:hover {
      opacity: 0.9;
    }
    
    @media (max-width: 480px) {
      .btn {
        width: 140px;
        height: 48px;
        min-width: 140px;
        min-height: 48px;
        max-width: 140px;
        max-height: 48px;
        font-size: 16px;
      }
    }
    
    @media (max-width: 360px) {
      .btn {
        width: 130px;
        height: 46px;
        min-width: 130px;
        min-height: 46px;
        max-width: 130px;
        max-height: 46px;
        font-size: 15px;
      }
      
      .btn-group {
        gap: 12px;
      }
    }
    
    #response {
      margin-top: 10px;
      font-size: 16px;
      background: rgba(0,0,0,0.4);
      border-radius: var(--border-radius-sm);
      padding: 10px;
      min-height: 40px;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.7);
      opacity: 0;
      transform: translateY(-10px);
      transition: opacity 0.5s ease, transform 0.5s ease;
      color: #76ff03;
      overflow-x: auto;
    }
    #response.show {
      opacity: 1;
      transform: translateY(0);
    }
    #response table {
      width: 100%;
      min-width: 400px;
      border-collapse: collapse;
      text-align: center;
      border: 1px solid #555;
      font-size: 14px;
    }
    #response th, #response td {
      padding: 4px;
      border: 1px solid #666;
      white-space: nowrap;
    }
    .loading {
      font-size: 16px;
      color: #ff4444;
      animation: blink 1s infinite;
    }
    .loading::before {
      content: "";
      display: inline-block;
      width: 18px;
      height: 18px;
      border: 3px solid #ccc;
      border-radius: 50%;
      border-top-color: #09f;
      animation: spin 0.8s infinite linear;
      vertical-align: middle;
      margin-right: 5px;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0.4; } 100% { opacity: 1; } }
    .overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.75);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }
    .overlay.show { display: flex; }
    .modal {
      background: #222;
      padding: 24px;
      border-radius: var(--border-radius-md);
      width: 90%;
      max-width: 400px;
      color: #fff;
      text-align: center;
      box-shadow: 0 8px 20px rgba(0,0,0,0.8);
    }
    .modal h3 {
      font-size: 24px;
      margin-bottom: 12px;
      letter-spacing: 1px;
    }
    .modal p {
      font-size: 18px;
      margin-bottom: 20px;
    }
    .modal-buttons {
      display: flex;
      gap: 12px;
      justify-content: space-evenly;
    }
    .modal .btn {
      flex: 1;
      padding: 10px;
      border-radius: var(--border-radius-sm);
      font-size: 20px;
      font-family: 'Roboto Mono', monospace;
      cursor: pointer;
      transition: background 0.3s, transform 0.3s;
      box-shadow: none;
      border: none;
    }
    .btn-confirm { background: var(--btn-on-from); color: #fff; }
    .btn-cancel { background: var(--btn-off-from); color: #fff; }
    .btn-confirm:hover { background: var(--btn-on-to); }
    .btn-cancel:hover { background: var(--btn-off-to); }
    #incognitoPrompt {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.85);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10000;
    }
    #incognitoPrompt .prompt-content {
      background: #222;
      border: 2px solid #444;
      border-radius: var(--border-radius-md);
      padding: 20px 30px;
      text-align: center;
      max-width: 450px;
      width: 90%;
    }
    #incognitoPrompt h2 {
      margin-bottom: 20px;
      color: #fff;
      font-size: 24px;
    }
    #incognitoPrompt p {
      margin-bottom: 20px;
      font-size: 18px;
      color: #ddd;
    }
    #incognitoPrompt .button-group {
      display: flex;
      gap: var(--spacing-md);
      justify-content: center;
    }
    #incognitoPrompt .button-group button {
      font-family: 'Roboto Mono', monospace;
      flex: 1;
      min-width: 120px;
      padding: 12px 20px;
      font-size: 16px;
      border: none;
      border-radius: var(--border-radius-sm);
      cursor: pointer;
      transition: background 0.3s;
    }
    #confirmIncognito { background-color: var(--btn-on-from); color: #fff; }
    #confirmIncognito:hover { background-color: var(--btn-on-to); }
    #cancelIncognito { background-color: var(--btn-off-from); color: #fff; }
    #cancelIncognito:hover { background-color: var(--btn-off-to); }
    #videoTutorialModal {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.85);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 11000;
      padding: 20px;
    }
    #videoTutorialModal .video-content {
      background: #222;
      border: 2px solid #444;
      border-radius: var(--border-radius-md);
      padding: 20px;
      text-align: center;
      max-width: 600px;
      width: 100%;
      position: relative;
    }
    #videoTutorialModal video {
      width: 100%;
      height: auto;
      border-radius: var(--border-radius-sm);
    }
    #videoTutorialModal .fallback-link {
      display: none;
      margin-top: 10px;
      color: #76ff03;
      font-size: 18px;
    }
    #videoTutorialModal .close-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: transparent;
      border: none;
      color: #fff;
      font-size: 24px;
      cursor: pointer;
    }
    .network-status {
      position: fixed;
      top: 10px;
      right: 10px;
      padding: 6px 12px;  /* 統一與 AI Bot 的 padding */
      border-radius: 20px;
      font-size: 14px;
      font-weight: bold;
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      z-index: 999;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .network-status .material-icons {
      font-size: 18px;
    }
    .network-good { background-color: rgba(76, 175, 80, 0.9); color: #fff; }      /* 良好 - 深綠色 */
    .network-online { background-color: rgba(40, 167, 69, 0.8); color: #fff; }
    .network-medium { background-color: rgba(255, 193, 7, 0.9); color: #fff; font-weight: 600; }  /* 一般 - 黃色，改用白色文字 */
    .network-poor { background-color: rgba(255, 152, 0, 0.9); color: #fff; }      /* 緩慢 - 橘色 */
    .network-offline { background-color: rgba(220, 53, 69, 0.8); color: #fff; }   /* 離線 - 紅色 */
    
    .help-status {
      position: fixed;
      top: 10px;
      right: 110px;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 16px;
      font-weight: bold;
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      z-index: 999;
      transition: all 0.3s ease;
      background-color: rgba(52, 152, 219, 0.8);
    }
    
    .help-status a {
      color: #fff;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .help-status .material-icons {
      font-size: 18px;
    }
    
    .help-status:hover {
      background-color: rgba(52, 152, 219, 1);
      transform: translateY(-1px);
    }
    .error-message {
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      color: red;
      font-size: 14px;
      display: none;
      margin-top: 5px;
      opacity: 0;
      transition: opacity 0.5s ease;
    }
    .error-message.show { display: block; opacity: 1; }


    .form-modal {
      background: rgba(28, 28, 30, 0.95);
      border-radius: 16px;
      width: 90%;
      max-width: 450px;
      color: #fff;
      text-align: left;
      overflow: hidden;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(255, 255, 255, 0.1);
      animation: modalFadeIn 0.3s ease;
      -webkit-backdrop-filter: blur(20px);
      backdrop-filter: blur(20px);
    }
    
    @keyframes modalFadeIn {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }
    
    .form-modal-header {
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 16px 20px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .form-modal-header h3 {
      font-size: 20px;
      margin: 0;
      letter-spacing: 0.5px;
      font-weight: 600;
      text-align: center;
      width: 100%;
    }
    
    .form-modal-content {
      padding: 8px 0;
    }
    
    .form-item-container {
      display: flex;
      flex-direction: column;
    }
    
    .form-item {
      display: flex;
      align-items: center;
      padding: 16px 20px;
      cursor: pointer;
      transition: background-color 0.2s;
      position: relative;
    }
    
    .form-item:after {
      content: '';
      position: absolute;
      left: 20px;
      right: 20px;
      bottom: 0;
      height: 1px;
      background: rgba(255, 255, 255, 0.1);
    }
    
    .form-item:last-child:after {
      display: none;
    }
    
    .form-item:hover {
      background-color: rgba(255, 255, 255, 0.05);
    }
    
    .form-item:active {
      background-color: rgba(255, 255, 255, 0.1);
    }
    
    .form-icon {
      width: 42px;
      height: 42px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 16px;
      background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
      flex-shrink: 0;
    }
    
    .form-icon .material-icons {
      font-size: 24px;
    }
    
    #overtimeForm .form-icon {
      color: #ff9800;
    }
    
    #cardCorrectionForm .form-icon {
      color: #03a9f4;
    }
    
    #leaveRequestForm .form-icon {
      color: #4caf50;
    }
    
    #shiftChangeForm .form-icon {
      color: #9c27b0;
    }
    
    /* 查詢介面的圖示顏色 */
    #cardCorrectionFormQuery .form-icon {
      color: #03a9f4;
    }
    
    #overtimeFormQuery .form-icon {
      color: #ff9800;
    }
    
    #leaveRequestFormQuery .form-icon {
      color: #4caf50;
    }
    
    #shiftChangeFormQuery .form-icon {
      color: #9c27b0;
    }
    
    /* 查詢類型選擇介面的圖示樣式 */
    #btnAttendanceQuery .form-icon {
      color: #4caf50;  /* 綠色 - 出勤紀錄 */
    }
    
    #btnFormQuery .form-icon {
      color: #3498db;  /* 藍色 - 表單紀錄 */
    }
    
    .form-info {
      flex: 1;
    }
    
    .form-info h4 {
      font-size: 17px;
      margin: 0 0 4px 0;
      font-weight: 600;
    }
    
    .form-info p {
      font-size: 14px;
      margin: 0;
      color: #999;
    }
    
    .form-arrow {
      color: #777;
    }
    
    /* 維修中狀態樣式 */
    .form-item.maintenance {
      background-color: rgba(128, 128, 128, 0.2);
      cursor: not-allowed;
      opacity: 0.6;
      position: relative;
    }
    
    .form-item.maintenance .form-icon {
      color: #888 !important;
      background: linear-gradient(135deg, rgba(128,128,128,0.1), rgba(128,128,128,0.05));
    }
    
    .form-item.maintenance .form-info h4 {
      color: #888;
    }
    
    .form-item.maintenance .form-info p {
      color: #666;
    }
    
    .form-item.maintenance .form-arrow {
      color: #666;
    }
    
    .form-item.maintenance:hover {
      background-color: rgba(128, 128, 128, 0.2);
    }
    
    .form-item.maintenance:after {
      display: none !important;
    }
    
    .form-item.maintenance::before {
      content: '維修中';
      position: absolute;
      top: 50%;
      right: 15px;
      transform: translateY(-50%);
      background: #666;
      color: #fff;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: bold;
      z-index: 10;
    }
    
    .btn.disabled-button {
      opacity: 0.4;
      cursor: not-allowed;
      background: linear-gradient(to right, var(--btn-disabled-from), var(--btn-disabled-to)) !important;
    }
    
    .btn.disabled-button:hover {
      transform: none !important;
    }
    
    .btn.disabled-button:active {
      transform: none !important;
    }
    
    .overlay.show.form-overlay {
      -webkit-backdrop-filter: blur(5px);
      backdrop-filter: blur(5px);
    }
    
    @keyframes shimmer {
      0% { background-position: -1000px 0; }
      100% { background-position: 1000px 0; }
    }
    
    .skeleton-loader {
      background: linear-gradient(to right, #333 8%, #444 18%, #333 33%);
      background-size: 1000px 100%;
      animation: shimmer 2s infinite linear;
      border-radius: 4px;
    }
    
    .btn-cooldown {
      --progress: 0%;
      background-image: linear-gradient(to right, var(--color-from) 0%, var(--color-to) var(--progress), #666 var(--progress), #555 100%) !important;
      transition: --progress 0.3s linear;
    }
    
    .form-content {
      padding: 20px;
      max-height: 75vh;
      overflow-y: auto;
      overflow-x: hidden !important;
      max-width: 100% !important;
      scroll-behavior: smooth;
      -webkit-overflow-scrolling: touch;
    }

    .date-input-container,
    .time-input-container {
      display: flex;
      align-items: center;
      width: 100%;
    }
    
    .spacer-element {
      width: 60px;
      margin-left: 10px;
      visibility: hidden;
    }

    input[type="date"],
    input[type="time"],
    select,
    textarea {
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      display: block;
      width: 100%;
      font-size: 16px;
      padding: 12px;
      background-color: #333;
      color: #fff;
      border: 1px solid #555;
      border-radius: 5px;
    }

    input[type="date"]::-webkit-calendar-picker-indicator,
    input[type="time"]::-webkit-calendar-picker-indicator {
      filter: invert(1);
      opacity: 0.7;
    }

    .weekday-display {
      display: flex;
      align-items: center;
      justify-content: center;
      min-width: 60px;
      height: 42px;
      background-color: #444;
      color: #fff;
      border-radius: 5px;
      margin-left: 10px;
      font-weight: bold;
    }
    
    /* 表單內容最後一個子元素的底部間距 */
    .form-content > *:last-child {
      margin-bottom: 5px !important;
    }

    .form-buttons-container {
      display: flex;
      padding: 12px 16px;
      gap: 8px;
      width: 100%;
      box-sizing: border-box;
      justify-content: space-between;
      background-color: transparent; /* 透明背景，完全繼承父容器顏色 */
      border-radius: 8px;
      margin-top: 5px;  /* 改為 5px */
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      align-items: center;
      /* 緊湊單行設計 */
      min-height: 44px;
    }

    .form-buttons-container .btn {
      flex: 1;
      padding: 8px 8px;  /* 減少水平 padding 從 12px 到 8px */
      border: none;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      min-height: 32px;
    }

    .btn-confirm:disabled {
      opacity: 0.8;
      background: #666;
      color: #eee;
    }

    /* 上傳按鈕特殊樣式 */
    .btn-upload {
      background-color: transparent !important;
      color: #f5a623 !important;
      border: 2px solid #f5a623 !important;
    }

    .btn-upload:hover {
      background-color: #f5a623 !important;
      color: #ffffff !important;
      transform: translateY(-1px);
    }

    .btn-upload:active {
      transform: translateY(0);
    }

    /* 動態按鈕排序 */
    .form-buttons-container.two-buttons {
      justify-content: space-between;
    }
    
    /* 單一按鈕置中顯示 */
    .form-buttons-container.one-button {
      justify-content: center;
    }
    
    .form-buttons-container.one-button .btn {
      max-width: 250px;
    }

    .form-buttons-container.three-buttons {
      justify-content: space-between;
    }

    .form-buttons-container.three-buttons .btn-cancel {
      order: 1; /* 取消按鈕在左 */
    }

    .form-buttons-container.three-buttons .btn-confirm {
      order: 2; /* 提交按鈕在中 */
    }

    .form-buttons-container.three-buttons .btn-upload {
      order: 3; /* 上傳按鈕在右 */
    }

    /* 🔧 修復：平均寬度分配 - 確保三按鈕不會溢出 */
    .form-buttons-container.three-buttons .btn-cancel {
      flex: 1 1 0; /* 平均分配 */
      min-width: 0; /* 允許縮小 */
    }

    .form-buttons-container.three-buttons .btn-confirm {
      flex: 1 1 0; /* 平均分配 */
      min-width: 0; /* 允許縮小 */
    }

    .form-buttons-container.three-buttons .btn-upload {
      flex: 1 1 0; /* 平均分配 */
      min-width: 0; /* 允許縮小 */
    }

    @media (max-width: 480px) {
      .form-modal {
        width: 95%;
      }
      
      .form-content {
        padding: 15px;
        max-height: 85vh;
      }
      
      .date-input-container,
      .time-input-container {
        flex-direction: row;
        align-items: center;
      }
      
      .weekday-display {
        min-width: 50px;
        height: 38px;
        font-size: 14px;
      }
      
      /* 🔧 修復：小螢幕三按鈕佈局優化 */
      .form-buttons-container.three-buttons {
        gap: 6px; /* 縮小間距 */
      }
      
      .form-buttons-container.three-buttons .btn {
        padding: 8px 10px; /* 縮小內邊距 */
        font-size: 13px; /* 縮小字體 */
        gap: 4px; /* 縮小圖標間距 */
      }
      
      /* 平均分配已在上方設定，無需特殊處理 */
    }

    .ui-datepicker {
      background: #333;
      color: #fff;
      border: 1px solid #555;
      box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        padding: 10px;
      box-sizing: border-box;
    }
    
    .ui-datepicker .ui-datepicker-header {
      background: #444;
      color: #fff;
      border: none;
      border-radius: 3px;
    }
    
    .ui-datepicker .ui-datepicker-title {
      color: #fff;
    }
    
    .ui-datepicker .ui-datepicker-prev,
    .ui-datepicker .ui-datepicker-next {
      background: transparent;
      border: none;
      color: #fff;
    }
    
    .ui-datepicker th {
      color: #ccc;
    }
    
    .ui-datepicker td a {
      background: #444;
      color: #fff;
      border: none;
      text-align: center;
    }
    
    .ui-datepicker td a.ui-state-active {
      background: #3498db;
      color: #fff;
    }
    
    .ui-datepicker td a.ui-state-highlight {
      background: #555;
      color: #4CAF50;
    }
    
    .ui-timepicker-div {
      background: #333;
      color: #fff;
      background-color: #222;
      padding: 15px;
      border-radius: 0;
      border: none;
      border-top: 1px solid #444;
      box-shadow: none;
      }
    
    .ui-datepicker-buttonpane,
    .ui-timepicker-buttonpane {
      background: transparent;
      border: none;
    }
    
    .form-input,
    input.datepicker,
    input.timepicker {
      text-align: left;
      padding-left: 15px;
    }
    
    .form-input, .weekday-display, .date-input-container, .time-input-container, .radio-option {
      height: 42px;
      box-sizing: border-box;
    }
    
    .weekday-display {
      width: 60px;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    
    .ui-timepicker-div .ui_tpicker_time,
    .ui-timepicker-div .ui_tpicker_time_label,
    .ui-timepicker-div .ui_tpicker_hour_label,
    .ui-timepicker-div .ui_tpicker_minute_label {
      display: none;
    }
    
    .ui-timepicker-div dl {
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: flex-start;
      margin: 0;
      padding: 0;
    }
    
    .radio-option {
      transition: background-color 0.2s, transform 0.1s;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 42px;
      box-sizing: border-box;
    }
    
    .radio-option:active {
      transform: scale(0.98);
    }
    
    .checkmark {
      transition: opacity 0.2s;
    }
    
    .ui-datepicker, .ui-timepicker-div {
      margin-top: 0;
    }
    
    .ui-slider {
      display: none;
    }
    
    .ui-timepicker-div dd {
      margin: 0;
      padding: 0;
      width: 48%;
      text-align: center;
    }
    
    .ui-timepicker-div dd.ui_tpicker_hour:before {
      content: '小時';
      display: block;
      margin-bottom: 5px;
      color: #ccc;
      font-size: 14px;
      text-align: center;
    }
    
    .ui-timepicker-div dd.ui_tpicker_minute:before {
      content: '分鐘';
      display: block;
      margin-bottom: 5px;
      color: #ccc;
      font-size: 14px;
      text-align: center;
    }
    
    .ui-timepicker-div select {
      width: 95%;
      margin: 0 auto;
      text-align: center;
      text-align-last: center;
      -webkit-text-align-last: center;
      -moz-text-align-last: center;
    }
    
    .ui-timepicker-div select option {
      text-align: center;
    }
    
    .ui-timepicker-div .timepicker-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid #444;
    }
    
    .ui-timepicker-div .timepicker-button {
      background-color: #333;
      color: #fff;
      border: 1px solid #555;
      border-radius: 5px;
      padding: 8px 15px;
      font-size: 14px;
      cursor: pointer;
      transition: background-color 0.2s;
      min-width: 80px;
      text-align: center;
    }
    
    .ui-timepicker-div .timepicker-button.confirm {
      background-color: #2c7a3e;
      border-color: #1e5a2d;
    }
    
    .ui-timepicker-div .timepicker-button.cancel {
      background-color: #666;
      border-color: #555;
    }
    
    .ui-timepicker-div .timepicker-button:hover {
      opacity: 0.9;
    }
    
    /* 日期輸入容器寬度調整 */
    .date-input-container {
      position: relative;
      width: calc(100% - 90px);
    }
    
    /* 日期輸入框寬度設置 */
    .date-input-container input.datepicker {
      width: 100%;
    }
    
    /* 星期顯示位置調整 */
    .weekday-display {
      position: absolute;
      right: -90px;
      top: 0;
      height: 42px;
      width: 80px;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    
    /* 補充/強化類型選項居中 */
    .radio-option {
      display: flex;
      justify-content: center;
      align-items: center;
      text-align: center;
    }
    
    .radio-option .checkmark,
    .radio-option span {
      margin: 0;
      padding: 0;
    }
    
    .radio-option .checkmark {
      margin-right: 8px;
    }
    
    /* 確保日期選擇器標題和表格正確顯示 */
    .ui-datepicker .ui-datepicker-header {
      background: #444;
      border: none;
      border-radius: 4px;
      padding: 8px;
      font-size: 16px;
    }
    
    .ui-datepicker table {
      margin: 10px 0;
      width: 100%;
      border-collapse: separate;
      border-spacing: 2px;
    }
    
    .ui-datepicker th {
      padding: 8px 0;
      font-size: 14px;
    }
    
    .ui-datepicker td {
      padding: 2px;
      height: 36px;
    }
    
    .ui-datepicker td a {
      text-align: center;
      padding: 8px 0;
      height: 32px;
      line-height: 16px;
      border-radius: 4px;
      font-size: 15px;
    }
    
    /* SVG選項樣式 */
    .svg-option {
      overflow: hidden;
    }
    
    .svg-option svg {
      display: block;
    }
    
    .svg-option svg text {
      font-family: 'Roboto Mono', monospace;
    }

/* 表單錯誤容器 */
    .form-error-container {
      color: #ff4444;
      font-size: 14px;
      margin-top: 15px;
      padding: 10px;
      border-radius: 5px;
      background-color: rgba(255, 68, 68, 0.1);
      display: none;
      text-align: center !important;
    }
    
    /* 輸入錯誤訊息 */
    .input-error, .textarea-error {
      color: #ff4444;
      font-size: 12px;
      margin-top: 5px;
      display: none;
    }
    
    /* 滾動到頂部按鈕 */
    .scroll-top-button {
      position: fixed;
      right: 20px;
      bottom: 90px;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-color: rgba(52, 152, 219, 0.7);
      color: #fff;
      border: none;
      display: none;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 9999;
    }

    /* 禁止表單左右滑動 */
    .form-content {
      overflow-x: hidden !important;
      max-width: 100% !important;
    }
    
    /* 確保表單容器不超出邊界 */
    .form-modal {
      overflow-x: hidden !important;
      max-width: 100% !important;
    }
    
    .form-group,
    .form-input,
    .form-textarea,
    .date-input-container,
    .time-input-container,
    .radio-container,
    .form-error-container {
      max-width: 100% !important;
      box-sizing: border-box !important;
    }
    
    /* 必填標記樣式 */
    .required-mark {
      color: #ff4444;
      font-size: 16px;
      margin-left: 5px;
      font-weight: normal;
      white-space: nowrap;
      font-family: 'Material Icons';
      vertical-align: middle;
    }
    
    /* 禁止表單左右滑動的樣式 - 星期顯示修復版 */
    /* 禁止表單內容左右滑動 */
    .form-content {
      overflow-x: hidden !important;
    }
    
    /* 確保表單容器不超出邊界，但保留足夠空間給星期顯示 */
    .form-modal {
      overflow-x: hidden !important;
      max-width: 450px !important;
      width: 90% !important;
    }
    
    /* 修改內部元素確保不超出容器但保留星期顯示所需空間 */
    .form-group,
    .form-input,
    .form-textarea,
    .radio-container,
    .form-error-container {
      max-width: 100% !important;
      box-sizing: border-box !important;
    }
    
    /* 確保日期輸入容器有足夠空間容納星期顯示 */
    .date-input-container {
      position: relative !important;
      width: calc(100% - 90px) !important;
      max-width: calc(100% - 90px) !important;
      box-sizing: border-box !important;
      margin-right: 90px !important; /* 為星期顯示預留空間 */
    }
    
    /* 確保星期顯示元素始終可見 */
    .weekday-display {
      position: absolute !important;
      right: -90px !important;
      top: 0 !important;
      height: 42px !important;
      width: 80px !important;
      display: flex !important;
      justify-content: center !important;
      align-items: center !important;
      visibility: visible !important;
      z-index: 10 !important; /* 確保顯示層級高於其他元素 */
    }
    
    /* 時間輸入容器特別處理 */
    .time-input-container {
      max-width: 100% !important;
      box-sizing: border-box !important;
    }
    
    .form-error-container {
      text-align: center !important;
    }
    
    /* 增強跨平台響應式設計 */
    @media (max-width: 480px) {
      .form-modal {
        width: 95% !important;
        max-width: 95% !important;
      }
      
      /* 移動設備上調整星期顯示尺寸 */
      .weekday-display {
        width: 70px !important;
        right: -80px !important;
        font-size: 14px !important;
      }
    }
    
    /* 檔案上傳提示樣式 */
    .file-upload-note {
      margin-top: 15px;
      padding: 10px;
      background-color: rgba(52, 152, 219, 0.1);
      border-radius: 5px;
      border-left: 3px solid #3498db;
      color: #3498db;
      font-size: 12px;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* 佐證文件提示樣式 - 橙色背景 */
    .file-requirement-hint {
      background: rgba(255, 152, 0, 0.1) !important;
      border: 1px solid #ff9800 !important;
      border-radius: 8px !important;
      padding: 12px 16px !important;
      margin-bottom: 15px !important;
      text-align: center !important;
      color: #ff9800 !important;
      font-weight: 500 !important;
      font-size: 16px !important;
    }

    /* 行內錯誤提示樣式 */
    .form-group .error-inline {
      display: none;
      color: #ff4444;
      font-size: 12px;
      margin-top: 5px;
      align-items: center;
      gap: 5px;
    }

    .form-group.has-error .error-inline {
      display: flex;
      animation: slideDown 0.3s ease-out;
    }

    .form-group.has-error input,
    .form-group.has-error select,
    .form-group.has-error textarea {
      border-color: #ff4444 !important;
      background-color: rgba(255, 68, 68, 0.05);
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .file-upload-note .material-icons {
      margin-right: 8px;
      font-size: 18px;
    }

    /* 陰影立體風格按鈕樣式 */
    .back-button-shadow {
      position: absolute;
      left: 15px;
      background-color: #3a3a3a;
      border: none;
      color: white;
      padding: 6px 12px;
      display: flex;
      align-items: center;
      border-radius: 8px;
      cursor: pointer;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3), 
                  inset 0 1px 0 rgba(255, 255, 255, 0.15);
      transition: all 0.2s;
    }
    
    .back-button-shadow .material-icons {
      font-size: 20px;
      margin-right: 6px;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.4);
    }
    
    .back-button-shadow .back-text {
      font-size: 14px;
      font-weight: 500;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    }
    
    .back-button-shadow:hover {
      background-color: #454545;
      transform: translateY(-1px);
      box-shadow: 0 3px 7px rgba(0, 0, 0, 0.4), 
                  inset 0 1px 0 rgba(255, 255, 255, 0.2);
    }
    
    .back-button-shadow:active {
      background-color: #333333;
      transform: translateY(1px);
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3), 
                  inset 0 1px 2px rgba(0, 0, 0, 0.3);
    }
    
    /* 響應式設計 */
    @media (max-width: 480px) {
      .back-button-shadow {
        padding: 4px 10px;
      }
      
      .back-button-shadow .material-icons {
        font-size: 18px;
        margin-right: 4px;
      }
      
      .back-button-shadow .back-text {
        font-size: 12px;
      }
    }

    /* V3 查詢記錄表格樣式 */
    .record-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      font-size: 15px;
      color: #fff;
    }
    .record-table th, .record-table td {
      border: 1px solid #555;
      padding: 10px 8px;
      text-align: center;
      word-wrap: break-word; /* 避免文字過長換行 */
    }
    .record-table th {
      background-color: #444;
      font-weight: bold;
    }
    .record-table tbody tr:nth-child(odd) {
      background-color: #2c2c2c;
    }
    .record-table .time-in {
      color: #2ecc71; /* 綠色 */
      font-weight: bold;
    }
    .record-table .time-out {
      color: #e74c3c; /* 紅色 */
      font-weight: bold;
    }
    .info-message {
      text-align: center;
      color: #999;
      margin-top: 20px;
      font-size: 16px;
    }
  </style>

<body>
  <div id="networkStatus" class="network-status network-good">
    <span class="material-icons">wifi</span>
    <span class="status-text">良好</span>
  </div>
  <div id="helpSupport" class="help-status">
    <a href="https://line.me/R/ti/p/@934pxusr" target="_blank">
      <span class="material-icons">smart_toy</span>
      <span>AI Bot</span>
    </a>
  </div>
  <div class="container">
    <img class="logo" src="https://i.imgur.com/7obx0vd.jpg" alt="Logo" crossorigin="anonymous">
    <h1>OS_Office_ANN</h1>
    <h2>請鍵入身分證後四碼執行打卡</h2>

    <form id="idForm">
      <label for="idCode">請點擊下方框內鍵入後四碼</label>
      <div class="input-group">
        <input 
          type="password" 
          id="idCode" 
          name="idCode" 
          required 
          pattern="\d{4}" 
          maxlength="4" 
          inputmode="numeric"
          autocomplete="off" 
          autocorrect="off" 
          autocapitalize="off" 
          spellcheck="false"
        />
        <button type="button" class="toggle-btn" id="toggleBtn" aria-label="切換密碼顯示">
          <span class="material-icons" id="eyeIcon">visibility</span>
        </button>
        <span class="error-message"></span>
      </div>
    </form>
    <div class="btn-group">
      <!-- 第一行：上班、下班、各項表單 -->
      <button type="button" class="btn btn-on" id="btnOn" data-original-text="上班" disabled>上班</button>
      <button type="button" class="btn btn-off" id="btnOff" data-original-text="下班" disabled>下班</button>
      <button type="button" class="btn btn-form" id="btnForm" data-original-text="各項表單" disabled>各項表單</button>
      <!-- 第二行：查詢紀錄、查閱班表、查閱公告 -->
      <button type="button" class="btn btn-query" id="btnQuery" data-original-text="查詢紀錄" disabled>查詢紀錄</button>
      <button type="button" class="btn btn-schedule" id="btnSchedule" data-original-text="查閱班表" disabled>查閱班表</button>
      <button type="button" class="btn btn-notice" id="btnNotice" data-original-text="查閱公告" disabled>查閱公告</button>
      <!-- 第三行：主管限定、個人資訊、測試定位 -->
      <button type="button" class="btn btn-manager disabled-button" id="btnManager" data-original-text="主管限定" disabled>主管限定</button>
      <button type="button" class="btn btn-personal disabled-button" id="btnPersonal" data-original-text="Duty日誌" disabled>Duty日誌</button>
      <button type="button" class="btn btn-test" id="btnTest" data-original-text="測試定位" disabled>測試定位</button>
    </div>
    <div id="response" role="status" aria-live="polite"></div>
  </div>
  
  <div id="overlay" class="overlay">
    <div class="modal">
      <h3 id="modal-title">提示</h3>
      <p id="modal-message">提示訊息</p>
      <div class="modal-buttons">
        <button id="modal-confirm" class="btn btn-confirm">確定</button>
        <button id="modal-cancel" class="btn btn-cancel">取消</button>
      </div>
    </div>
  </div>
  
  <div id="incognitoPrompt">
    <div class="prompt-content">
      <h2>系統提示</h2>
      <p>請確保關閉無痕瀏覽器模式後再執行</p>
      <div class="button-group">
        <button id="confirmIncognito">我已確認關閉</button>
        <button id="cancelIncognito">取消</button>
      </div>
    </div>
  </div>
  
  <!-- ★ 方案 1：超狠立即處理腳本 -->
  <script>
  (function() {
    'use strict';
    
    console.log('⚡ 方案 1 啟動：HTML 內嵌立即處理');
    
    // 立即顯示提示框（不等待任何載入）
    const prompt = document.getElementById('incognitoPrompt');
    if (prompt) {
      prompt.style.display = 'flex';
      console.log('✓ 無痕提示框已立即顯示');
    }
    
    // 使用事件委派確保點擊事件一定有效
    document.addEventListener('click', function(e) {
      // 處理確認按鈕
      if (e.target && e.target.id === 'confirmIncognito') {
        const prompt = document.getElementById('incognitoPrompt');
        if (prompt) {
          prompt.style.display = 'none';
          console.log('✓ 無痕提示已關閉（HTML內嵌處理）');
          
          // 可選：觸發自定義事件通知主系統
          window.dispatchEvent(new CustomEvent('incognitoPromptClosed', {
            detail: { method: 'html-inline', timestamp: Date.now() }
          }));
        }
        e.preventDefault();
        e.stopPropagation();
      }
      
      // 處理取消按鈕
      if (e.target && e.target.id === 'cancelIncognito') {
        alert('已取消｜無法使用系統');
        window.location.href = 'about:blank';
        e.preventDefault();
        e.stopPropagation();
      }
    });
    
    // 可選：鍵盤支援（ESC 鍵關閉）
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' || e.keyCode === 27) {
        const prompt = document.getElementById('incognitoPrompt');
        if (prompt && prompt.style.display !== 'none') {
          prompt.style.display = 'none';
          console.log('✓ 無痕提示已關閉（ESC鍵）');
        }
      }
    });
    
    console.log('⚡ 方案 1 設置完成：無痕提示可立即操作（0延遲）');
  })();
  </script>
  
  <div id="videoTutorialModal" class="video-modal">
    <div class="video-content">
      <button class="close-btn" id="closeVideoModal">×</button>
      <video id="tutorialVideo" controls>
        <source src="https://i.imgur.com/Wnemzxu.mp4" type="video/mp4">
        您的瀏覽器不支援影片播放，請點此觀看：
        <a href="https://i.imgur.com/Wnemzxu.mp4" target="_blank">https://i.imgur.com/Wnemzxu.mp4</a>
      </video>
      <div class="fallback-link" id="videoFallback">
        <a href="https://i.imgur.com/Wnemzxu.mp4" target="_blank">無法播放影片？請點此觀看</a>
      </div>
    </div>
  </div>
  
  <div id="formApplicationModal" class="overlay">
    <div class="form-modal">
      <div class="form-modal-header">
        <h3>各項表單</h3>
      </div>
      <div class="form-modal-content">
        <div class="form-item-container">
          <!-- 補卡申請 -->
          <div class="form-item" id="cardCorrectionForm">
            <div class="form-icon">
              <span class="material-icons">credit_card</span>
            </div>
            <div class="form-info">
              <h4>補卡申請</h4>
              <p>忘記打卡或打卡錯誤</p>
            </div>
            <div class="form-arrow">
              <span class="material-icons">chevron_right</span>
            </div>
          </div>
          
          <!-- 加班申請 -->
          <div class="form-item" id="overtimeForm">
            <div class="form-icon">
              <span class="material-icons">schedule</span>
            </div>
            <div class="form-info">
              <h4>加班申請</h4>
              <p>提交加班時數及原因</p>
            </div>
            <div class="form-arrow">
              <span class="material-icons">chevron_right</span>
            </div>
          </div>
          
          <!-- 請假申請 -->
          <div class="form-item" id="leaveRequestForm">
            <div class="form-icon">
              <span class="material-icons">event_busy</span>
            </div>
            <div class="form-info">
              <h4>請假申請</h4>
              <p>請假日期及假別選擇</p>
            </div>
            <div class="form-arrow">
              <span class="material-icons">chevron_right</span>
            </div>
          </div>
          
          <!-- 異動班別 -->
          <div class="form-item maintenance" id="shiftChangeForm">
            <div class="form-icon">
              <span class="material-icons">compare_arrows</span>
            </div>
            <div class="form-info">
              <h4>異動班別</h4>
              <p>變更排班班別</p>
            </div>
            <div class="form-arrow">
              <span class="material-icons">chevron_right</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

<script src="ui.js" defer></script>
<script src="form-handler.ui.js" defer></script>
<script src="main.js" defer></script>
</body>
</html>
